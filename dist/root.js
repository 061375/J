"use strict";import{Constants}from"./init.js";import{Public}from"./init.js";import*as Ajax from"./api/ajax.js";export default{};export class Root{constructor(t,i,s){this.t=t,this.$t=i,this.is_itterable=s,this.$domo=[],this.dom_i=-1,this._exists=!0,void 0!==this.$t&&null!==this.$t&&0!=this.$t.length||(this._exists=!1)}append(t){var i,s,e;const r=new DOMParser;if(!this.checkMissingError())return this;if(this.dom_i>-1)this.is_itterable&&(null===(i=this.$t[this.dom_i])||void 0===i||i.appendChild(r.parseFromString(t,"text/html").body.firstChild));else if(this.is_itterable)for(let i=0;i<this.$t.length;i++)null===(s=this.$t[i])||void 0===s||s.appendChild(r.parseFromString(t,"text/html").body.firstChild);else null===(e=this.$t)||void 0===e||e.appendChild(r.parseFromString(t,"text/html").body.firstChild);return this}attr(t,i=""){var s,e,r,o,h,l;if(!this.checkMissingError())return this;if(i.length>0)if(this.dom_i>-1)null===(s=this.$t[this.dom_i])||void 0===s||s.setAttribute(t,i);else if(this.is_itterable)for(let s=0;s<this.$t.length;s++)null===(e=this.$t[s])||void 0===e||e.setAttribute(t,i);else null===(r=this.$t)||void 0===r||r.setAttribute(t,i);else if(this.dom_i>-1)this.$domo[this.dom_i]=null===(o=this.$t[this.dom_i])||void 0===o?void 0:o.getAttribute(t);else if(this.is_itterable)for(let i=0;i<this.$t.length;i++)this.$domo[i]=null===(h=this.$t[i])||void 0===h?void 0:h.getAttribute(t);else this.$domo=null===(l=this.$t)||void 0===l?void 0:l.getAttribute(t);return this}css(t,i){var s,e,r,o,h,l;if(!this.checkMissingError())return this;if(i.length>0)if(this.dom_i>-1)this.$t[this.dom_i].style[t]=i;else if(this.is_itterable)for(let s=0;s<this.$t.length;s++)this.$t[s].style[t]=i;else this.$t.style[t]=i;else if(this.dom_i>-1)this.$t[this.dom_i]=null===(e=null===(s=this.$t[this.dom_i])||void 0===s?void 0:s.style)||void 0===e?void 0:e[t];else if(this.is_itterable)for(let i=0;i<this.$t.length;i++)this.$t[i]=null===(o=null===(r=this.$t[i])||void 0===r?void 0:r.style)||void 0===o?void 0:o[t];else this.$t=null===(l=null===(h=this.$t)||void 0===h?void 0:h.style)||void 0===l?void 0:l[t];return this}data(t,i=""){var s,e,r,o,h,l;if(!this.checkMissingError())return this;if(i.length>0)if(this.dom_i>-1)this.$t[this.dom_i].dataset[t]=i;else if(this.is_itterable)for(let s=0;s<this.$t.length;s++)this.$domo[s].dataset[t]=i;else this.$domo.dataset[t]=i;else if(this.dom_i>-1)this.$t[this.dom_i]=null===(e=null===(s=this.$t[this.dom_i])||void 0===s?void 0:s.dataset)||void 0===e?void 0:e[t];else if(this.is_itterable)for(let i=0;i<this.$t.length;i++)this.$domo[i]=null===(o=null===(r=this.$t[i])||void 0===r?void 0:r.dataset)||void 0===o?void 0:o[t];else this.$domo=null===(l=null===(h=this.$t)||void 0===h?void 0:h.dataset)||void 0===l?void 0:l[t];return this}each(t){if(!this.checkMissingError())return this;if(this.dom_i>-1){if(this.is_itterable)for(let i=0;i<this.$t[this.dom_i].length;i++)this.dom_i=i,t(this)}else if(this.is_itterable)for(let i=0;i<this.$t.length;i++)this.dom_i=i,t(this);return this.dom_i=-1,this}eq(t){return this.checkMissingError()?(this.dom_i>-1?this.$t[this.dom_i]=this.$t[this.dom_i][t]:this.is_itterable&&(this.$t=this.$t[t]),this):this}exists(){return this._exists}find(t){this.$t=$create(t)}get(){return-1==this.dom_i?this.$t:this.$domo}height(t=""){return this.checkMissingError()?this.heightwidth("height",t):this}html(t=""){var i,s,e;if(!this.checkMissingError())return this;if(t.length>0&&null!=this.$t)if(this.dom_i>-1)this.$t[this.dom_i].innerHTML=t;else if(this.is_itterable)for(let i=0;i<this.$t.length;i++)this.$t[i].innerHTML=t;else this.$t.innerHTML=t;else if(this.dom_i>-1)this.$t[this.dom_i]=null===(i=this.$t[this.dom_i])||void 0===i?void 0:i.innerHTML;else if(this.is_itterable)for(let t=0;t<this.$t.length;t++)this.$t[t]=null===(s=this.$t[t])||void 0===s?void 0:s.innerHTML;else this.$t=null===(e=this.$t)||void 0===e?void 0:e.innerHTML;return this}remove(){var t,i,s;if(!this.checkMissingError())return this;if(this.dom_i>-1)this.is_itterable&&(null===(t=this.$t[this.dom_i])||void 0===t||t.remove());else if(this.is_itterable)for(let t=0;t<this.$t.length;t++)null===(i=this.$t[t])||void 0===i||i.remove();else null===(s=this.$t)||void 0===s||s.remove();return this}val(){var t,i;if(!this.checkMissingError())return this;if(this.is_itterable)for(let i=0;i<this.$t.length;i++)this.$domo[i]=null===(t=this.$t[i])||void 0===t?void 0:t.value;else this.$domo=null===(i=this.$t)||void 0===i?void 0:i.value;return this}width(t=""){return this.checkMissingError()?this.heightwidth("width",t):this}heightwidth(t,i=""){var s,e,r;if(i.length>0){if(i.match(/^(\d+)([a-zA-Z]+)$/))if(this.dom_i>-1)this.$t[this.dom_i].style[t]=i;else if(this.is_itterable)for(let s=0;s<this.$t.length;s++)this.$t[s].style[t]=i;else this.$t.style[t]=i;return this}return t=t.charAt(0).toUpperCase()+t.slice(1),Math.max(null===(s=this.$t)||void 0===s?void 0:s[`scroll${t}`],null===(e=this.$t)||void 0===e?void 0:e[`offset${t}`],null===(r=this.$t)||void 0===r?void 0:r[`client${t}`])}hasClass(t){return!!this.checkMissingError()&&(this.$t.classList?this.$t.classList.contains(t):!!this.$t.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)")))}addClass(t){this.classWrap(t,this.addClassWrap)}removeClass(t){this.classWrap(t,this.removeClassWrap)}classWrap(t,i){if(this.dom_i>-1)if(this.is_itterable){for(let t=0;t<this.$t[this.dom_i].length;t++)this.dom_i=t;this.$t[this.dom_i]=i(this.$t[this.dom_i],t)}else this.$t[this.dom_i]=i(this.$t[this.dom_i],t);else if(this.is_itterable)for(let s=0;s<this.$t.length;s++)this.$t[s]=i(this.$t[s],t);else this.$t=i(this.$t,t);return this.dom_i=-1,this}addClassWrap(t,i){return t.classList?t.classList.add(i):t.hasClass(i)||(t.className+=i),t}removeClassWrap(t,i){if(t.classList)t.classList.remove(i);else if(this.hasClass(i)){var s=new RegExp("(\\s|^)"+i+"(\\s|$)");t.className=t.className.replace(s," ")}return t}static DTDateToOracle(t){return Helpers.dtdto(t)}static buildQueryString(t,i){return Helpers.bqs(t,i)}checkMissingError(){return!!this._exists||(Debug.ErrorHandler("Node not found ("+this.t+")"),!1)}}export var $=function(t){return $create(t)};function $create(t){let i,s=!1;return Helpers.isID(t)?i=document.querySelector(t):(i=document.querySelectorAll(t),s=!0),new Root(t,i,s)}export class Helpers{static ToBool(t){switch(t){case!0:case"TRUE":case"true":case"yes":case"1":return!0;default:return!1}}static isID(t){return/^#([a-zA-Z_$][a-zA-Z\d_$]*)$/.test(t)}static dtdto(t){const i=String(t);if("string"!=typeof i||-1==i.indexOf("/"))return"";const s=i.split("/");if(3!==s.length)return"";const e=parseInt(s[0]),r=parseInt(s[1]),o=parseInt(s[2]);if(isNaN(e)||isNaN(r)||isNaN(o)||e<1||e>12||r<1||r>31)return"";return`${r<10?"0"+r:r}-${["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"][e-1]}-${o.toString().substring(2)}`}static bqs(t,i){const s=[];for(const e in t)if(t.hasOwnProperty(e)){const r=t[e];if(null!=r){const t=i?i+"["+e+"]":e;"object"==typeof r?s.push(Helpers.bqs(r,t)):s.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}}return s.join("&")}}export class Cookie{static get(t){const i=`; ${document.cookie}`.split(`; ${t}=`);if(2===i.length)return i.pop().split(";").shift()}static set(t,i,s,e,r,o){let h=`${encodeURIComponent(t)}=${encodeURIComponent(i)}`;s instanceof Date&&(h+=`; expires=${s.toString()}`),e&&(h+=`; path=${e}`),r&&(h+=`; domain=${r}`),o&&(h+="; secure"),document.cookie=h}static remove(t,i,s,e){Cookie.set(t,"",new Date(0),i,s,e)}}export class Debug{static ErrorHandler(t,i=""){if(Public.ISERRORING=!0,!Debug.AllowedExceptions(t)){console.log("ErrorHandler ",t,i);var s=!1;Public.SOFTERROR?(t=Constants.ERRORSTATUS.softerror[0].msg.replace("[message]",t),Constants.ERRORSTATUS.softerror[0].alert&&!Public.ISERRORING2&&alert(t+" "+i),Constants.ERRORSTATUS.softerror[0].email&&(s=!0),Public.SOFTERROR=!1):(t=(t+=Constants.ERRORSTATUS.unknown[0].msg+" ").replace("[message]",i),Constants.ERRORSTATUS.unknown[0].alert&&!Public.ISERRORING2&&alert("[10] "+t),Constants.ERRORSTATUS.unknown[0].email&&(s=!0)),t=document.getElementsByTagName("title")[0].innerHTML+" --\x3e "+t,s&&Debug.SendErrors(t,i)}}static AllowedExceptions(t){if(console.log("AllowedExceptions",t),void 0===t)return!0;for(let i=0;i<Constants.ALLOWED_EXCEPTIONS.length;i++)if("string"==typeof t&&(null==t?void 0:t.indexOf(Constants.ALLOWED_EXCEPTIONS[i]))>-1)return!0;return!1}static SendErrors(t,i){if(Public.ISERRORING2)return;Public.ISERRORING2=!0;let s=[],e=Array.from(document.getElementsByTagName("script"));for(let t=0;t<e.length;t++)s.push(e[t].src);new Ajax.Base(Constants.AJAXERRORPATH).get(Constants.AJAXERRORMETHOD,{log:JSON.stringify({msg:t,error:i,scripts:s})},(function(t){console.log(t)}))}}